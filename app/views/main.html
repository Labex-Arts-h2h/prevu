<!-- ng-controller="MainCtrl" -->
<div class="">
    <div class="row head-line">
        <div class="col-md-12 text-center">
            <h1>Circulation des livres - P8</h1>
        </div>
        <div class="col-md-6">            
        <p>Consectetur adipisicing elit, sed do eiusmod
            tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
            quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
            consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
            cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
            proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
        </div>
        <div class="col-md-6">            
        <p>Consectetur adipisicing elit, sed do eiusmod
            tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
            quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
            consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
            cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
            proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
        </div>
    </div>
    <div  class="row">
        <div class="col-md-4 text-center">
            <div class="cartouche abstract">
                <h3>Livres empruntés</h3>
                <span>au moins une fois</span>
                <h4><span class="value">153 331</span></h4>
                <div ng-controller="LinechartCtrl">
                    <nvd3-line-chart
                    data="books_count_graph"
                    height="130"
                    y="yFunction()"
                    x="xFunction()"
                    margin="{left:7,top:5,bottom:0,right:7}"
                    interactive="true"
                    forcey="[41500,45000]"
                    tooltips="true"
                    tooltipcontent="toolTipContentFunction()"
                    >
                    <svg></svg>
                    </nvd3-line-chart>
                </div>
            </div>
            <footer>
                <span class="legend">Période : </span>
                <span class="period">2012-02-01 - 2014-02-01</span>
            </footer>
        </div>
        <div class="col-md-4 text-center">
            <div class="cartouche abstract">
                <h3>Nombre de Prêts</h3>
                <span>sur l'ensemble de la période</span>
                <h4><span class="value">324 401</span></h4>
                <div ng-controller="LinechartCtrl">
                    <nvd3-line-chart
                    data="issues_count_graph"
                    height="130"
                    y="yFunction()"
                    x="xFunction()"
                    margin="{left:7,top:5,bottom:0,right:7}"
                    interactive="true"
                    forcey="[75000,85000]"
                    tooltips="true"
                    tooltipcontent="toolTipContentFunction()"
                    >
                    <svg></svg>
                    </nvd3-line-chart>
                </div>
            </div>
            <footer>
                <span class="legend">Période : </span>
                <span class="period">2012-02-01 - 2014-02-01</span>
            </footer>
        </div>
        <div class="col-md-4 text-center">
            <div class="cartouche abstract">
                <h3>Lecteurs Actifs</h3>
                <span>ayant pris au moins un livre</span>
                <h4><span class="value">32 449</span></h4>
                <div ng-controller="LinechartCtrl">
                    <nvd3-line-chart
                    data="borrowers_count_graph"
                    height="130"
                    y="yFunction()"
                    x="xFunction()"
                    margin="{left:7,top:5,bottom:0,right:7}"
                    interactive="true"
                    forcey="[9300,10500]"
                    tooltips="true"
                    tooltipcontent="toolTipContentFunction()"
                    >
                    <svg></svg>
                    </nvd3-line-chart>
                </div>
            </div>
            <footer>
                <span class="legend">Période : </span>
                <span class="period">2012-02-01 - 2014-02-01</span>
            </footer>             
        </div>
    </div>
    <div class="row head-line">
        <div class="col-md-6 ">
            <h1>Circulation des livres - P8</h1>
        </div>
        <div class="col-md-6">            
        <p>Consectetur adipisicing elit, sed do eiusmod
            tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
            quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
            consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
            cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
            proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
        </div>
        <div class="col-md-6 ">
            <h1>Circulation des livres - P8</h1>
        </div>
        <div class="col-md-6">            
        <p>Consectetur adipisicing elit, sed do eiusmod
            tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
            quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
            consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
            cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
            proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12 cartouche">
            <head>
                <h3>Historique des prêts</h3>
            </head>
            <div ng-controller="DiscretebarchartCtrl">
<!--                 <nvd3-discrete-bar-chart
                data="statsIssuesAllByMonth"
                id="yExample"
                margin="{left:80,top:50,bottom:50,right:50}"
                showXAxis="true"
                showYAxis="true"
                showValues="true"
                staggerLabels="true"
                height="300"
                tooltips="true"
                y="yFunction()"
                x="xFunction()"
                forcey="[2000,20000]"
                useInteractiveGuideLine="true">
                <svg ></svg>
                </nvd3-discrete-bar-chart> -->
                <nvd3-line-chart
                data="statsIssuesAllByMonth"
                height="300"
                y="yFunctionIssues()"
                x="xFunctionIssues()"
                margin="{left:80,top:15,bottom:30,right:80}"
                interactive="true"
                tooltips="true"
                showXAxis="true"
                showYAxis="true"
                xAxisTickFormat="xAxisTickFormatFunction()"
                tooltipcontent="toolTipContentFunction()"
                >
                <svg></svg>
                </nvd3-line-chart>
            </div>
        </div>
        <footer class="col-md-12">
            <span class="legend">Période : </span>
            <span class="period">2012-02-01 - 2014-02-01</span>
        </footer>
    </div>
    <div class="row">
        <div class="col-md-12 cartouche">
            <head>
                <div class="col-md-10">
                    <h3>Répartitions des Niveaux par Mois</h3>
                </div>
                <div class="col-md-2">
                    <ui-select ng-model="selectedSemestre" theme="selectize"  ng-change="setSemestre_issues_niveau_light(selectedSemestre)" style="width: 150px;"> 
                      <ui-select-match placeholder="Choisir un semestre...">{{$select.selected.name}}</ui-select-match>
                      <ui-select-choices repeat="semestre in semestres| filter: $select.search">
                        <span ng-bind-html="semestre.name | highlight: $select.search"></span>
                      </ui-select-choices>
                    </ui-select>     
                </div>
            </head>
            <div ng-controller="StackedareachartCtrl">
                <nvd3-multi-bar-chart
                data="issues_niveau_light"
                showXAxis="true"
                showYAxis="true"
                y="yFunction()"
                x="xFunction()"
                height="400"
                margin="{left:80,top:50,bottom:50,right:50}"
                interactive="true"
                yAxisTickFormat="yAxisTickFormatFunction()"
                xAxisTickFormat="xAxisTickFormatFunction()"
                tooltips="true"
                showLegend="true"
                showControls="true">
                <svg></svg>
                </nvd3-multi-bar-chart>
            </div>
        </div>
        <footer class="col-md-12">
            <span class="legend">Période : </span>
            <span class="period">2012-02-01 - 2014-02-01</span>
        </footer>
    </div>
    <hr/>
    <div class="row ">
        <div class="col-md-12 cartouche">
            <head>
                <div class="col-md-8">
                    <h3>Livres les plus populaires par Ufr</h3>
                </div>
                <div class="col-md-4">
<!--                     <select ng-model="selectedUFR" ng-options="ufrKey.name for ufrKey in ufrKeys" ng-change="setUfr(selectedUFR)"><option value="">Choisir une UFR</option></select> -->
                    <ui-select class="pull-right" ng-model="selectedUFR.selected" theme="selectize"   ng-change="setUfr(selectedUFR.selected)" style="width: 300px;"> 
                      <ui-select-match placeholder="Choisir une UFR...">{{$select.selected.name}}</ui-select-match>
                      <ui-select-choices repeat="ufrKey in ufrKeys| filter: $select.search">
                        <span ng-bind-html="ufrKey.name | highlight: $select.search"></span>
                      </ui-select-choices>
                    </ui-select>                    
                </div>
            </head>


            <div style="height:370px;" class="col-md-3 text-center bookWarp"  ng-repeat="topBookByUfr in ByUfr_books.values | limitTo:4">
                <a href="#/livre?biblionumber=">
                    <div class="bookFront center-block" style="background:-webkit-linear-gradient(left, rgba(0, 0, 0, 0.1) 0%, rgba(211, 211, 211, 0.1) 5%, rgba(255, 255, 255, 0.15) 5%, rgba(255, 255, 255, 0.1) 9%, rgba(0, 0, 0, 0.01) 100%), url({{bookCover.cover.LargeImage}}) center, #febd17; background: linear-gradient(to right, rgba(0, 0, 0, 0.1) 0%, rgba(211, 211, 211, 0.1) 5%, rgba(255, 255, 255, 0.15) 5%, rgba(255, 255, 255, 0.1) 9%, rgba(0, 0, 0, 0.01) 100%),url({{bookCover.cover.LargeImage}}) center, #febd17; background-size:cover;">
                    </div>
                    <h4>{{topBookByUfr.title}}</h4>
                    Prêts : {{topBookByUfr.issuesTotal}}        
                </a>
            </div>
        </div>
        <footer class="col-md-12">
            <span class="legend">Période : </span>
            <span class="period">2012-02-01 - 2014-02-01</span>
        </footer>
    </div>
    <div class="row">
        <div class="col-md-12 cartouche">
            <head>
                <div class="col-md-8">
                    <h3>Stats par Ufr</h3>
                </div>
                <div class="col-md-4">
                    <ui-select class="pull-right" ng-model="selectedUFR.selected" theme="selectize"   ng-change="setUfr(selectedUFR.selected)" style="width: 300px;"> 
                      <ui-select-match placeholder="Choisir une UFR...">{{$select.selected.name}}</ui-select-match>
                      <ui-select-choices repeat="ufrKey in ufrKeys| filter: $select.search">
                        <span ng-bind-html="ufrKey.name | highlight: $select.search"></span>
                      </ui-select-choices>
                    </ui-select>                      
                </div>
            </head>
            <div class="col-md-12">                
                <div class="col-md-2">
                    <h5>Nombre de prêts</h5>
                    <span class="value">{{ByUfr_issues_numbers}}</span>
                </div>
                <div ng-controller="LinechartCtrl" class="col-md-10">
                    <nvd3-line-chart
                    data="issues_ufrOnlyUfr"
                    height="150"
                    y="yFunctionUFR()"
                    x="xFunctionUFR()"
                    margin="{left:80,top:15,bottom:30,right:80}"
                    interactive="true"
                    tooltips="true"
                    showXAxis="true"
                    showYAxis="true"
                    xAxisTickFormat="xAxisTickFormatFunction()"
                    tooltipcontent="toolTipContentFunctionUFR()"
                    >
                    <svg></svg>
                    </nvd3-line-chart>
                </div>
                <div ng-controller="MultibarhorizchartCtrl" class="col-md-6">
                    <h4>Nombre de prêts par secteur</h4>
                    <nvd3-multi-bar-horizontal-chart
                    data="ByUfr_ccode"
                    id="ByUfr_ccode"
                    height="400"
                    margin="{left:120,top:5,bottom:50,right:50}"
                    y="yFunction()"
                    x="xFunction()"
                    showXAxis="true"
                    showValues="true">
                    <svg></svg>
                    </nvd3-multi-bar-horizontal-chart>
                </div>
                <div ng-controller="PiechartCtrl" class="col-md-6">
                    <h4>Profil lecteurs</h4>
                    <h5>Nombre de lecteurs </h5>
                    <span class="value">{{ByUfr_borrowers_numbers}}</span>
                        <nvd3-pie-chart
                         data="ByUfr_borrowers_sex"
                         id="ByUfr_borrowers_sex"
                         margin="{left:0,top:10,bottom:10,right:0}"
                         x="xFunction()"
                         y="yFunctionBorrowersUfr()"
                         width="300"
                         tooltips="true"
                         showValues="true"
                         showLabels="true"
                         donut="true"
                         interactive="true"
                         donutLabelsOutside="false"
                         >
                         <svg></svg>
                     </nvd3-pie-chart>
                    <h5>âge moyen du lecteurs </h5>
                    <span class="value">{{ByUfr_borrowers_age}}</span>
                </div>
            </div>
        </div>
        <footer class="col-md-12">
            <span class="legend">Période : </span>
            <span class="period">2012-02-01 - 2014-02-01</span>
        </footer>
    </div>

    <hr />
    <div class="row">
        <div class="col-md-12 cartouche">
            <head>
                <div class="col-md-10">
                    <h2>Top des prêts</h2>    
                </div>
                <div class="col-md-2">
                    Filtrer par discipline :
                    <select ng-model="selecteds">
                        <option ng-repeat="ccode in stats.ccode"  value="{{ccode.ccode}}">{{ccode.ccode}}
                        </option>
                    </select>                    
                </div>
            </head>
            <div style="height:400px;" class="col-md-3 text-center bookWarp"  ng-repeat="book in topBooks | filter:{ccode: selecteds}">
                <a href="#/livre?biblionumber=">
                    <h4>#{{book.top}} - {{book.title}}</h4>
                    <h6>{{book.author_nom}}, {{book.author_prenom}} - {{book.author_date}}</h6>
                    <div class="bookFront center-block" style="background:-webkit-linear-gradient(left, rgba(0, 0, 0, 0.1) 0%, rgba(211, 211, 211, 0.1) 5%, rgba(255, 255, 255, 0.15) 5%, rgba(255, 255, 255, 0.1) 9%, rgba(0, 0, 0, 0.01) 100%), url({{bookCover.cover.LargeImage}}) center, #febd17; background: linear-gradient(to right, rgba(0, 0, 0, 0.1) 0%, rgba(211, 211, 211, 0.1) 5%, rgba(255, 255, 255, 0.15) 5%, rgba(255, 255, 255, 0.1) 9%, rgba(0, 0, 0, 0.01) 100%),url({{book.LargeImage}}) center, #febd17; background-size:cover;">
                    </div>
                    <p>
                    <span>Date de publication : {{book.publicationyear}}</span><br/>
                    <span>Prêts : {{book.issues}}</span><br/>
                    <span>ccode : {{book.ccode}}</span>
                    </p>    
                </a>
            </div>
        </div>
    </div>


</div>