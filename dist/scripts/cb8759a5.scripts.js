"use strict";angular.module("prevuApp",["config","ngCookies","ngResource","ngSanitize","ngRoute","ui.bootstrap","ui.select","nvd3ChartDirectives"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/auteur",{templateUrl:"views/auteur.html",controller:"AuteurCtrl",reloadOnSearch:!1}).when("/livre",{templateUrl:"views/issues.html",controller:"IssuesCtrl",reloadOnSearch:!1}).when("/experiment",{templateUrl:"views/experiment.html",controller:"ExperimentCtrl",reloadOnSearch:!1}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl",reloadOnSearch:!1}).otherwise({redirectTo:"/"})}]),angular.module("config",[]).constant("ENV",{name:"development",apiEndpoint:"http://localhost:8888/prevu/application/"}),angular.module("prevuApp").controller("MainCtrl",["$scope","$rootScope","$filter","$location","$anchorScroll","prevuAPIservice",function(a,b,c,d,e,f){b.bodyClass="viewMain",f.getTotalUfr().success(function(b){a.ufrs=b,a.ufr=a.ufrs[0]}),f.getTotalUfrSeule().success(function(b){a.ufrsTotal=b}),f.getTopCouvByUfr("arts").success(function(b){f.getMultipleCoverBook(b.slice(0,10)).success(function(b){a.topBooksCovers=b}),a.topBooks=b}),a.setUfr=function(b){f.getTopCouvByUfr(b).success(function(b){f.getMultipleCoverBook(b.slice(0,10)).success(function(b){a.topBooksCovers=b}),a.topBooks=b})},f.getTopCouv().success(function(b){f.getMultipleCoverBook(b.slice(0,10)).success(function(b){a.topBooksCover=responseCovers}),a.bookpopulaires=b}),f.getStatsIssuesAllByMonth().success(function(b){a.statsIssuesAllByMonth=[{key:"Prêts",area:!0,values:b.stats}]}),f.getIssuesByCategorie().success(function(b){a.statsIssuesByCategorie=b.stats}),f.getIssuesByUfr().success(function(b){a.statsIssuesUfr=[{key:"Prêts",area:!0,values:b.stats}]}),f.getIssuesBySemestre().success(function(b){a.statsIssuesBySemestre=[{key:"Prêts",area:!0,values:b}]}),f.getIssuesBookBySemestre().success(function(b){a.statsIssuesBookBySemestre=[{key:"Prêts",area:!0,values:b.stats}]}),f.getIssuesBorrowernumberBySemestre().success(function(b){a.statsIssuesBorrowerBySemestre=[{key:"Prêts",area:!0,values:b}]}),f.getTotalBorrowers().success(function(b){a.totalBorrowers=b}),f.getTotalIssues().success(function(b){a.totalissues=b}),f.getTotalBooks().success(function(b){a.totalbooks=b}),f.getMoyenneAgeBorrower().success(function(b){a.moyenneage=b}),f.getIssuesBySex().success(function(b){a.statsIssuesBySex=b}),f.getYears().success(function(b){a.annees=b,a.annee=a.annees[0]}),f.getIssuesAllByMonthYear(2012).success(function(b){a.issuesAllByMonthYear=[{key:"Prêts",area:!0,values:b}]}),a.setYearMois=function(b){f.getIssuesAllByMonthYear(b).success(function(b){a.issuesAllByMonthYear=[{key:"Prêts",area:!0,values:b}]})},f.getYears().success(function(b){a.annees=b,a.annee=a.annees[0]}),f.getIssuesMonthUfr("ARTS").success(function(b){a.issuesMonthUfr=[{key:"Prêts",values:b}]}),f.getIssuesCcodeUfr("arts").success(function(b){a.issuesCcodeUfr=[{key:"Prêts",area:!0,values:b}]}),f.getIssuesBySexUfr("arts").success(function(b){a.issuesSexUfr=b}),a.setUfrStats=function(b){f.getIssuesMonthUfr(b).success(function(b){a.issuesMonthUfr=[{key:"Prêts",values:b}]}),f.getIssuesBySexUfr(b).success(function(b){a.issuesSexUfr=b}),f.getIssuesCcodeUfr(b).success(function(b){a.issuesCcodeUfr=[{key:"Prêts",area:!0,values:b}]})},f.getIssuesMatiere(2012).success(function(b){a.issuesMatieres=b}),a.setYearVedette=function(b){f.getIssuesMatiere(b).success(function(b){a.issuesMatieres=b})},f.getSemestres().success(function(b){a.semestres=b,a.semestre=a.semestres[0]}),f.getIssuesMonthNiveau("Semestre 1-2012").success(function(b){a.issuesMonthNiveau=b}),a.setSemestre=function(b){f.getIssuesMonthNiveau(b).success(function(b){a.issuesMonthNiveau=b})},f.getIssuesMonthMatiere("2012").success(function(b){a.issuesMonthMatiere=b}),a.setyearmatiere=function(b){f.getIssuesMonthMatiere(b).success(function(b){a.issuesMonthMatiere=b})},f.getStatsMain().success(function(b){function c(a,b){for(var c=0,d=a.length;d>c;c+=1)if(a[c].key===b)return a[c]}a.books_count_graph=[{key:"books_count_graph",area:!0,values:b[0].books_count_graph}],a.issues_count_graph=[{key:"issues_count_graph",area:!0,values:b[0].issues_count_graph}],a.borrowers_count_graph=[{key:"borrowers_count_graph",area:!0,values:b[0].borrowers_count_graph}],a.borrowers_sex=b[0].borrowers_sex,a.borrowers_age=b[0].borrowers_age,a.issues_categoryCode=b[0].issues_categoryCode,a.issues_UfrRepartition=[{key:"Ufr",values:b[0].issues_UfrRepartition.slice(0,15)}],a.semestres=[{name:"Semestre 2 - 2012",id:"Semestre2012"},{name:"Semestre 1 - 2013",id:"Semestre2012-2013_1"},{name:"Semestre 2 - 2013",id:"Semestre2012-2013_2"},{name:"Semestre 1 - 2014",id:"Semestre2013-2014"}],a.selectedSemestre=a.semestres[1],a.issues_niveau_light=b[0].issues_niveau_light[a.semestres[1].id],a.setSemestre_issues_niveau_light=function(c){a.issues_niveau_light=b[0].issues_niveau_light[c.id]},a.ByUfr_books=b[0].ByUfr.books,a.ByUfr_ccode=b[0].ByUfr.ccode;var g=new Array;angular.forEach(b[0].ByUfr.books,function(b){g.push({name:a.listUfr[b.key]?a.listUfr[b.key]:b.key,key:b.key})}),a.ufrKeys=g,a.selectedUFR={},a.selectedUFR.selected=a.ufrKeys[1],a.ByUfr_ccode=[{key:a.ufrKeys[1].key,values:b[0].ByUfr.ccode[a.ufrKeys[1].key].values.slice(0,10)}],a.ByUfr_books=b[0].ByUfr.books[a.ufrKeys[1].key],f.getMultipleCoverBook(b[0].ByUfr.books[a.ufrKeys[1].key].values.slice(0,10)).success(function(b){a.ByUfr_booksCover=b}),a.issues_ufrOnlyUfr=[c(b[0].issues_ufr,a.ufrKeys[1].key)],a.ByUfr_borrowers_sex=b[0].ByUfr.borrowers_sex[a.ufrKeys[1].key].values,a.ByUfr_borrowers_age=b[0].ByUfr.borrowers_age[a.ufrKeys[1].key],a.ByUfr_issues_numbers=b[0].ByUfr.issues_numbers[a.ufrKeys[1].key],a.ByUfr_borrowers_numbers=b[0].ByUfr.borrowers_numbers[a.ufrKeys[1].key],a.gotoExplorer=function(){d.hash("explorer-scroll"),e()},a.gotoBegin=function(){d.hash("general-scroll"),e()}})}]),angular.module("prevuApp").filter("objectByKeyValFilter",function(){return function(a,b,c){var d={};return angular.forEach(a,function(a,e){a[b]&&a[b]==c&&(d[e]=a)}),d}}),angular.module("prevuApp").controller("AuteurCtrl",["$scope","$rootScope","$routeParams","$location","$http","prevuAPIservice","ENV",function(a,b,c,d,e,f,g){b.bodyClass="viewBook",a.searchAuthorClass="search-author-open",a.isFocus=!0;var h=function(b){var c=new Miso.Dataset({data:b});c.fetch({success:function(){a.stats={docs:this.length,issues:this.sum("issues"),issuesMax:this.max("issues"),issuesMin:this.min("issues"),renewals:this.sum("renewals"),years:this.mean("publicationyear").toFixed(0)}}})},i=function(b){a.info=b,f.getIssuesBySex().success(function(b){a.statsIssuesBySex=b}),f.getBookByAuthor(b).success(function(b){a.books=b.search,h(b.search),j(b.search)}),f.getBookByAuthorCover(b).success(function(b){a.bookscovers=b.search,j(b.search)}),f.getBookByAuthorIssuesSex(b).success(function(b){a.sexissues=b.search}),f.getBookByAuthorIssuesLangue(b).success(function(b){a.langueissues=b.search}),f.getBookByAuthorIssuesPays(b).success(function(b){a.paysissues=b.search})},j=function(b){a.booksCovers=[],console.log(b),f.getMultipleCoverBook(b).success(function(b){a.booksCovers=b}),angular.forEach(b,function(b){f.getCoverBookAmazon(b.biblionumber).success(function(c){a.booksCovers.push({biblionumber:b.biblionumber,item:b,cover:c})})})};a.search=function(){i(a.queryTerm),a.isFocus=!1,d.search("nom",a.queryTerm.author_nom),d.search("prenom",a.queryTerm.author_prenom),a.queryTerm=a.queryTerm.author_nom+" "+a.queryTerm.author_prenom,a.searchAuthorClass="search-author-close",b.bodyClass=null},a.suggestAuthors=function(a){return e.get(g.apiEndpoint+"api/author/search/"+a).then(function(a){var b=[];return angular.forEach(a.data.search,function(a){b.push(a)}),b})}}]),angular.module("prevuApp").directive("focusMe",["$timeout","$parse",function(a,b){return{link:function(c,d,e){var f=b(e.focusMe);c.$watch(f,function(b){b===!0&&a(function(){d[0].focus()})}),d.bind("blur",function(){c.$apply(f.assign(c,!1))})}}}]),angular.module("prevuApp").factory("Books",["$resource",function(a){return a("http://localhost:8888/prevu/api/search/:auteurName",{auteurName:"@auteurName"},{loan:{method:"PUT",params:{bookId:"@bookId"},isArray:!1}})}]),angular.module("prevuApp").directive("stupidTable",function(){return{restrict:"A",link:function(a,b){b.stupidtable(),b.on("aftertablesort",function(a,b){var c=$(this).find("th");c.find(".arrow").remove();var d=$.fn.stupidtable.dir,e=b.direction===d.ASC?"&uarr;":"&darr;";c.eq(b.column).append('<span class="arrow">'+e+"</span>")})}}}),angular.module("prevuApp").factory("prevuAPIservice",["$http","ENV",function(a,b){var c={},d=b.apiEndpoint;return console.log(d),c.getBookByBiblionumber=function(b){return a({url:d+"api/book/"+b})},c.searchAuthor=function(b){return a({url:d+"api/author/search/"+b})},c.searchBook=function(b){return a({url:d+"api/book/search/"+b})},c.searchBookByAuthor=function(b){return a({url:d+"api/books/author/search/"+b})},c.getBookByAuthor=function(b){return a({method:"POST",url:d+"api/books/author",headers:{"Content-Type":"application/json"},data:b})},c.getBookByAuthorCover=function(b){return a({method:"POST",url:d+"api/books/author/issues/cover",headers:{"Content-Type":"application/json"},data:b})},c.getBookByAuthorIssuesSex=function(b){return a({method:"POST",url:d+"api/books/author/issues/sex",headers:{"Content-Type":"application/json"},data:b})},c.getBookByAuthorIssuesPays=function(b){return a({method:"POST",url:d+"api/books/author/issues/pays",headers:{"Content-Type":"application/json"},data:b})},c.getBookByAuthorIssuesLangue=function(b){return a({method:"POST",url:d+"api/books/author/issues/langue",headers:{"Content-Type":"application/json"},data:b})},c.searchIssuesByTitle=function(b){return a({url:d+"api/issues/title/"+b})},c.searchIssuesByBiblionumber=function(b){return a({url:d+"api/issues/biblionumber/"+b})},c.searchIssuesByBiblionumbersexcategorie=function(b){return a({url:d+"api/issues/biblionumber/sexcategorie/"+b})},c.getAverageByBiblionumber=function(b){return a({url:d+"api/issues/biblionumber/"+b+"/averageAge"})},c.getTopBooks=function(){return a({url:d+"api/books/top/"})},c.getCoverBookAmazon=function(b){return a({url:d+"api/amazon/getCover.php?biblionumber="+b})},c.getCoverBook=function(b){return a({url:d+"api/book/cover/"+b})},c.getMultipleCoverBook=function(b){return a({method:"POST",url:d+"api/amazon/getMultipleCover.php",headers:{"Content-Type":"application/json"},data:b})},c.getStatsIssuesAllByMonth=function(){return a({url:d+"api/stats/issues/years/month"})},c.getIssuesByCategorie=function(){return a({url:d+"api/stats/issues/categorie"})},c.getIssuesBySemestre=function(){return a({url:d+"api/stats/issues/years/semestre"})},c.getIssuesBookBySemestre=function(){return a({url:d+"api/stats/issues/book/years/semestre"})},c.getIssuesBorrowernumberBySemestre=function(){return a({url:d+"api/stats/borrower/years/semestre"})},c.getTotalUfr=function(){return a({url:d+"api/totalUfr"})},c.getTotalUfrSeule=function(){return a({url:d+"api/totalUfrSeule"})},c.getTotalBorrowers=function(){return a({url:d+"api/totalBorrowers"})},c.getTotalIssues=function(){return a({url:d+"api/totalIssues"})},c.getTotalBooks=function(){return a({url:d+"api/totalBooks"})},c.getMoyenneAgeBorrower=function(){return a({url:d+"api/borrowers/averageAge"})},c.getIssuesBySex=function(){return a({url:d+"api/issues/sex"})},c.getIssuesCcodeUfr=function(b){return a({url:d+"api/issues/ufr/ccode/"+b})},c.getIssuesBySexUfr=function(b){return a({url:d+"api/issues/ufr/sex/"+b})},c.getIssuesMonthUfr=function(b){return a({url:d+"api/issues/ufr/month/"+b})},c.getIssuesByUfr=function(){return a({url:d+"api/stats/issues/ufr"})},c.getStatsIssuesAllByDay=function(){return a({url:d+"api/stats/issues/years/day"})},c.getStatsIssuesAllByMonthAverageNiveau=function(){return a({url:d+"api/stats/issues/years/month/niveau"})},c.getStatsIssuesAllByDayAverageNiveau=function(){return a({url:d+"api/stats/issues/years/day/niveau"})},c.getTopIssuesByUfr=function(b){return a({url:d+"api/stats/issues/ufr/"+b})},c.getStatsMain=function(b){return a({url:d+"api/statsJson/stats.json"})},c.getIssuesMatiere=function(b){return a({url:d+"api/issues/matiere/"+b})},c.getIssuesAllByMonthYear=function(b){return a({url:d+"api/stats/issues/years/month/"+b})},c.getCoverIssuesByUfr=function(b){return a({url:d+"api/stats/cover/ufr/"+b})},c.getIssuesMonthNiveau=function(b){return a({url:d+"api/issues/niveau/month/"+b})},c.getIssuesMonthMatiere=function(b){return a({url:d+"api/issues/matiere/month/"+b})},c.getTopCouvByUfr=function(b){return a({url:d+"api/stats/cover/ufr/"+b})},c.getTopCouv=function(){return a({url:d+"api/issues/livre/"})},c.getYears=function(){return a({url:d+"api/stats/years"})},c.getSemestres=function(){return a({url:d+"api/stats/semestres"})},c}]),angular.module("prevuApp").controller("IssuesCtrl",["$scope","$rootScope","$routeParams","$location","$http","prevuAPIservice","ENV",function(a,b,c,d,e,f,g){b.bodyClass="viewLivre",a.searchLivreClass="search-livre-open";var h=function(b){var c=new Miso.Dataset({data:b});c.fetch({success:function(){a.stats={issues:this.sum("issues"),renewals:this.sum("renewals"),etape:this.countBy("Etape").toJSON()}}})},i=function(b){f.searchIssuesByBiblionumber(b).success(function(c){a.issues=c,a.issuesUfrNiveau=[{key:"Prêts",values:c}],h(c),d.search("biblionumber",b)}),f.searchIssuesByBiblionumbersexcategorie(b).success(function(c){a.issuessexcategorie=c,h(c),d.search("biblionumber",b)}),f.getCoverBookAmazon(b).success(function(b){a.covers=b}),f.getAverageByBiblionumber(b).success(function(b){a.averageAge=b[0].averageAge})},j=function(b){f.getBookByBiblionumber(b).success(function(b){a.info=b,a.queryTerm||(a.queryTerm=a.info.title,a.searchLivreClass="search-livre-close")})};a.suggestBooks=function(a){return e.get(g.apiEndpoint+"api/book/search/"+a).then(function(a){var b=[];return angular.forEach(a.data.search,function(a){b.push(a)}),b})},a.search=function(){i(a.queryTerm.biblionumber),j(a.queryTerm.biblionumber),a.queryTerm=a.queryTerm.title,a.searchLivreClass="search-livre-close",b.bodyClass=null},a.clearInput=function(){a.queryTerm=null,a.stats=null,a.isFocus=!0};var k=d.search();k.biblionumber&&(i(k.biblionumber),j(k.biblionumber),b.bodyClass=null)}]),angular.module("prevuApp").controller("HeadernavCtrl",["$scope","$location",function(a,b){a.isActive=function(a){return a===b.path()}}]),angular.module("prevuApp").directive("visTimeline",function(){return{template:"<div></div>",restrict:"A",scope:{value:"=value"},link:function(a,b,c){a.$watch("value",function(a){if(a){for(var b=function(a,b){for(var c=[],d=0;d<a.length;d++){var e=a[d][b];-1===c.indexOf(e)&&c.push(e)}return c},c=b(a,"itemnumber"),d=new vis.DataSet,e=0;e<c.length;e++)d.add({id:c[e],content:"Ex. #"+(e+1)});var f=new vis.DataSet,g=0,h=document.getElementById("visualization");angular.forEach(a,function(a){f.add({id:g++,content:a.Niveau,niveau:a.Niveau,start:new Date(a.issuedate),startDate:a.issuedate,end:new Date(a.returndate),endDate:a.returndate,ufr:a.Ufr,className:a.Niveau,group:a.itemnumber})});var i={stack:!1,margin:{item:0,axis:5},min:new Date(2012,1,1),max:new Date(2015,4,1),orientation:"top",align:"center",moveable:!1,zoomable:!1,zoomMin:5184e5},j=new vis.Timeline(h);j.setOptions(i),j.setGroups(d),j.setItems(f),j.on("select",function(a){$(".itemInfos .niveau").html("<strong>Niveau : </strong>"+f.data[a.items[0]].niveau),$(".itemInfos .ufr").html("<strong>Ufr : </strong>"+f.data[a.items[0]].ufr),$(".itemInfos .dateStart").html("<strong>Date de début : </strong>"+f.data[a.items[0]].startDate),$(".itemInfos .dateEnd").html("<strong>Date de fin : </strong>"+f.data[a.items[0]].endDate)})}})}}}),angular.module("prevuApp").filter("groupBy",function(){return function(a,b){if(a){for(var c,d=[],e=0;e<a.length;e++)c||(c=[]),c.push(a[e]),(e+1)%b===0&&(d.push(c),c=null);return c&&d.push(c),d}}}),angular.module("prevuApp").controller("DiscretebarchartCtrl",["$scope",function(a){var b=["#2790b0","#79b5ac"];a.colorFunction=function(){return function(a,c){return b[c]}},a.xFunction=function(){return function(a){return a.month+"/"+a.year}},a.yFunction=function(a){return function(a){return d3.round(a.issues)}},a.xFunctionUfr=function(){return function(a){return a.Ufr}},a.yFunctionUfr=function(a){return function(a){return d3.round(a.issues)}},a.xFunctionIssues=function(){return function(a){return parseInt(a.issuesdate)}},a.yFunctionIssues=function(a){return function(a){return parseInt(a.issues)}},a.xFunctionNiveau=function(){return function(a){return a.Niveau}},a.yFunctionNiveau=function(a){return function(a){return d3.round(a.issues)}},a.xAxisTickFormatFunction=function(){return function(a){return d3.time.format("%b-%y")(new Date(1e3*a))}},a.toolTipContentFunction=function(){return function(a,b,c,d,e){return"<h3>"+d.point.issues+" prêts</h3><span>"+d3.time.format("%B-%y")(new Date(1e3*d.point.issuesdate))+"</span>"}},a.format=function(){return function(a){var b=d3.format("r0");return b(a)}},a.render=function(){console.log("render:")},a.$on("renderEnd.directive",function(a,b){console.log(b)}),a.$on("$viewContentLoaded",function(){console.log("render")})}]),angular.module("prevuApp").directive("spinLoader",function(){return{restrict:"E",transclude:!0,template:'<span class="{{ loading }}"></span><div ng-transclude ></div>'}}),angular.module("prevuApp").directive("onFinishRender",["$timeout",function(a){return{restrict:"A",link:function(a,b,c){a.$last===!0&&a.$evalAsync(c.onFinishRender)}}}]),angular.module("prevuApp").controller("LinechartCtrl",["$scope",function(a){var b=["#2790b0","#79b5ac"];a.colorFunction=function(){return function(a,c){return b[c]}},a.xFunction=function(){return function(a){return a.id}},a.yFunction=function(a){return function(a){return a.value}},a.xFunctionUFR=function(){return function(a){return a.issuesdate}},a.yFunctionUFR=function(a){return function(a){return a.issues}},a.xFunctionSemestreIssues=function(){return function(a){return a.year}},a.yFunctionSemestreIssues=function(a){return function(a){return d3.round(a.issues)}},a.xFunctionSemestreBook=function(){return function(a){return a.year}},a.yFunctionSemestreBook=function(a){return function(a){return d3.round(a.totalbook)}},a.xFunctionSemestreBorrower=function(){return function(a){return a.year}},a.yFunctionSemestreBorrower=function(a){return function(a){return d3.round(a.borrowernumber)}},a.xAxisTickFormatFunction=function(){return function(a){return d3.time.format("%d-%b-%y")(new Date(1e3*a))}},a.toolTipContentFunction=function(){return function(a,b,c,d,e){return"<h3>"+d.point.name+"</h3><span>"+d.point.value+"</span>"}},a.toolTipContentFunctionSemestreIssues=function(){return function(a,b,c,d,e){return"<h3>"+d.point.issues+"</h3> <span> Année "+d.point.year+"</span>"}},a.toolTipContentFunctionSemestreBook=function(){return function(a,b,c,d,e){return"<h3>"+d.point.totalbook+"</h3> <span> Année "+d.point.year+"</span>"}},a.toolTipContentFunctionSemestreBorrower=function(){return function(a,b,c,d,e){return"<h3>"+d.point.borrowernumber+"</h3> <span> Année "+d.point.year+"</span>"}},a.toolTipContentFunctionUFR=function(){return function(a,b,c,d,e){return"<h3>"+d.point.Ufr+"</h3>"+d.point.issues+" "+d3.time.format("%b-%y")(new Date(1e3*d.point.issuesdate))}},a.yAxisTickFormatFunction=function(){return function(a){return d3.format(",d")(a)}}}]),angular.module("prevuApp").controller("LinefocuschartCtrl",["$scope",function(a){a.xFunction=function(){return function(a){return a.timestamp}},a.yFunction=function(){return function(a){return a.issues}},a.xAxisTickFormatFunction=function(){return function(a){return d3.time.format("%d-%b-%y")(new Date(1e3*a))}},a.toolTipContentFunction=function(){return function(a){return"Super New Tooltip<h1>"+a+"</h1>"}},a.yAxisTickFormatFunction=function(){return function(a){return d3.format(",d")(a)}}}]),angular.module("prevuApp").controller("PiechartCtrl",["$scope",function(a){var b=["#2790b0","#c75233"],c=["#8dd3c7","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"];a.typePret={"10BUP8":"PEB","11BUP8":"Dépôts","12BUP8":"Récolement","13BUP8":"Collectivités","1BUP8":"Accès simple","2BUP8":"Prêt 2 livres","3BUP8":"Prêt Normal","4BUP8":"Prêt long","5BUP8":"Doctorants","6BUP8":"Etudiants IED","7BUP8":"Lecteurs empêchés","8BUP8":"Enseignants","9BUP8":"Personnel BU",INC:"A choisir"},a.color_schem=function(){return function(a,c){return b[c]}},a.color_viz=function(){return function(a,b){return c[b]}},a.xFunctionMonthIssues=function(){return function(a){return a.month}},a.yFunctionMonthIssues=function(){return function(a){return d3.round(a.issues)}},a.xFunctionCategorie=function(){return function(a){return a.description}},a.yFunctionCategorie=function(){return function(a){return parseInt(a.issues)}},a.xFunction=function(){return function(a){return a.sex}},a.xFunctionCatCode=function(){return function(a){return a.categorycode}},a.xFunctionLabel=function(){return function(a){return a.label}},a.yFunctionBorrowersUfr=function(){return function(a){return a.value}},a.xFunctionLabelTypePret=function(){return function(b){return a.typePret[b.label]?a.typePret[b.label]:b.label}},a.yFunction=function(a){return function(a){return a.issues}}}]),angular.module("prevuApp").controller("PiechartlangueCtrl",["$scope",function(a){var b=["#2790b0","#c75233"],c=["#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f","#8dd3c7","#bebada","#fb8072"];a.color_schem=function(){return function(a,c){return b[c]}},a.color_viz=function(){return function(a,b){return c[b]}},a.xFunction=function(){return function(a){return a.langue}},a.yFunction=function(a){return function(a){return a.issues}}}]),angular.module("prevuApp").controller("PiechartpaysCtrl",["$scope",function(a){var b=["#2790b0","#c75233"],c=["#8dd3c7","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"];a.color_schem=function(){return function(a,c){return b[c]}},a.color_viz=function(){return function(a,b){return c[b]}},a.xFunction=function(){return function(a){return a.pays}},a.yFunction=function(a){return function(a){return a.issues}}}]),angular.module("prevuApp").controller("MultibarhorizchartCtrl",["$scope",function(a){a.categoryBook={Y:"Histoire",E:"Sociologie",C:"Psychologie",VF:"Français",G:"Economie Stats",SA:"Arts plastiques",K:"Sciences éducation",B:"Philosophie",Z:"Fonds RDA",H:"Droit Admin",F:"Sciences politiques",W:"Linguistique",SC:"Cinéma",VA:"Anglais",FJD:"Fonds Jean Dresch",A:"Info Doc Médias",U:"Usuels Généralités",X:"Géographie",M:"Ethnologie",SP:"Photographie",ST:"Arts du spectacle",SM:"Musique",VL:"Littérature générale",L:"Sciences",VE:"Espagnol",VD:"Allemand",D:"Religion",N:"Informatique Tech",T:"Urbanisme",VR:"Langues slaves",VS:"Arabe Hébreu",VI:"Italien",VP:"Portugais",FEL:"Fonds Ernest Labrousse",VC:"Langues Asie",VG:"Latin Grec",FME:"Fonds Maghreb Europe",MAM:"Fonds M. A. Macciocchi",VM:"D'autres langues et littératures",CER:"Fonds CERASA",BD:"Bandes dessinées",YC:"Concours Histoire",CS:"Fonds Claude Simon",XC:"Concours Géographie"},a.listUfr={AESECOGES:"UFR AES, ÉCONOMIE ET GESTION",ARTS:"UFR ARTS, PHILOSOHIE, ESTHÉTIQUE",CC:"UFR CULTURE ET COMMUNICATION",ZZ:"ZZ",DROIT:"UFR DROIT","ED 031":"ED PRATIQUES ET THÉORIES DU SENS","ED 159":"ED ESTHÉTIQUE, SC. ET TECHNO. DES ARTS","ED 224":"ED COGNITION, LANGAGE, INTERACTION","ED 401":"ED SCIENCES SOCIALES","Form. perm":"FORMATION PERMANENTE",IED:"INSTITUT D'ENSEIGNEMENT À DISTANCE",IEE:"INSTITUT D'ETUDES EUROPÉENNES",IFG:"INSTITUT FRANÇAIS DE GÉOPOLITIQUE",IPT:"INFORMATIQUE POUR TOUS","IUT MONTR":"IUT DE MONTREUIL","IUT TREMBL":"IUT DE TREMBLAY-EN-FRANCE","LLCE-LEA":"UFR LLCE-LEA",MITSIC:"UFR M.I.T.S.I.C",PSYCHO:"UFR DE PSYCHOLOGIE",SDL:"UFR SCIENCES DU LANGAGE",SEPF:"UFR SCIENCES ÉDUCATION, PSYCHANALYSE,FLE",SUFICE:"SUFICE","T&S":"UFR TEXTES ET SOCIÉTÉS.",TES:"UFR TERRITOIRES, ENVIRONNEMENTS,SOCIÉTÉS"};var b=["#2790b0","#c75233"];a.color_schem=function(){return function(a,c){return b[c]}},a.xFunction=function(){return function(b){return a.categoryBook[b.label]}},a.xFunctionUfr=function(){return function(b){return a.listUfr[b.label]?a.listUfr[b.label]:b.label}},a.yFunction=function(a){return function(a){return d3.round(a.value)}},a.yAxisTickFormatFunction=function(){return function(a){return a.ufr}}}]),angular.module("prevuApp").controller("StackedareachartCtrl",["$scope",function(a){var b=["#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f","#8dd3c7","#bebada","#fb8072"];a.color_viz=function(){return function(a,c){return b[c]}},a.xFunction=function(){return function(a){return a.issuesdate}},a.yFunction=function(){return function(a){return a.issues}},a.xFunctionMonthIssues=function(){return function(a){return a.month}},a.yFunctionMonthIssues=function(){return function(a){return d3.round(a.issues)}},a.xAxisTickFormatFunction=function(){return function(a){return d3.time.format("%b-%y")(new Date(1e3*a))}},a.toolTipContentFunction=function(){return function(a){return"Super New Tooltip<h1>"+a+"</h1>"}},a.yAxisTickFormatFunction=function(){return function(a){return a}}}]),angular.module("prevuApp").controller("ExperimentCtrl",["$scope","prevuAPIservice",function(a,b){b.getStatsMain().success(function(b){a.issues_ufr=b[0].issues_ufr,a.issues_niveau=b[0].issues_niveau}),b.getStatsIssuesAllByDay().success(function(b){a.statsIssuesAllByDay=[{key:"Prêts",values:b.stats}]})}]),angular.module("prevuApp").controller("AboutCtrl",["$scope","$rootScope",function(a,b){b.bodyClass="viewAbout"}]),angular.module("prevuApp").controller("MultibarhorizchartCategorieCtrl",["$scope",function(a){var b=["#2790b0","#c75233"];a.color_schem=function(){return function(a,c){return b[c]}},a.xFunctionMonthIssues=function(){return function(a){return a.month}},a.yFunctionMonthIssues=function(){return function(a){return d3.round(a.issues)}},a.xFunctionCategorie=function(){return function(a){return a.description}},a.yFunctionCategorieIssues=function(){return function(a){return d3.round(a.issues)}},a.xFunctionSemestre=function(){return function(a){return a.semestre}},a.yFunctionSemestreIssues=function(){return function(a){return d3.round(a.issues)}},a.xFunctionCcodeUfr=function(){return function(a){return a.ccode}},a.yFunctionCcodeUfr=function(){return function(a){return d3.round(a.issues)}},a.xFunctionMonthIssues=function(){return function(a){return a.month}},a.yFunctionMonthIssues=function(){return function(a){return d3.round(a.issues)}}}]),angular.module("prevuApp").controller("PiechartVedetteMatiereCtrl",["$scope",function(a){var b=["#2790b0","#c75233"],c=["#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f","#8dd3c7","#bebada","#fb8072"];a.color_schem=function(){return function(a,c){return b[c]}},a.color_viz=function(){return function(a,b){return c[b]}},a.xFunction=function(){return function(a){return a.matiere}},a.yFunction=function(){return function(a){return a.total}}}]),angular.module("prevuApp").controller("MultibarhorizchartUfrCtrl",["$scope",function(a){var b=["#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"];a.color_schem=function(){return function(a,c){return b[c]}},a.xFunctionMonthIssues=function(){return function(a){return a.month}},a.yFunctionMonthIssues=function(){return function(a){return d3.round(a.issues)}},a.xFunctionUfr=function(){return function(a){return a.ufr}},a.yFunctionUfrIssues=function(){return function(a){return d3.round(a.issues)}},a.xFunctionSemestre=function(){return function(a){return a.semestre}},a.yFunctionSemestreIssues=function(){return function(a){return d3.round(a.issues)}},a.xFunctionMonthIssues=function(){return function(a){return a.month}},a.yFunctionMonthIssues=function(){return function(a){return d3.round(a.issues)}}}]),angular.module("prevuApp").controller("PiechartCategorieCtrl",["$scope",function(a){var b=["#2790b0","#c75233"],c=["#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f","#8dd3c7","#bebada","#fb8072"];a.color_schem=function(){return function(a,c){return b[c]}},a.color_viz=function(){return function(a,b){return c[b]}},a.xFunction=function(){return function(a){return a.description}},a.yFunction=function(){return function(a){return a.issues}},a.xFunctionsex=function(){return function(a){return a.sex}},a.yFunctionsex=function(){return function(a){return a.issues}},a.xFunctionsexufr=function(){return function(a){return a.sex}},a.yFunctionsexufr=function(){return function(a){return a.issues}}}]),angular.module("prevuApp").controller("PiechartSexPretCtrl",["$scope",function(a){var b=["#2790b0","#c75233"],c=["#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f","#8dd3c7","#bebada","#fb8072"];a.color_schem=function(){return function(a,c){return b[c]}},a.color_viz=function(){return function(a,b){return c[b]}},a.xFunctionsex=function(){return function(a){return a.sex}},a.yFunctionsex=function(){return function(a){return a.issues}}}]);