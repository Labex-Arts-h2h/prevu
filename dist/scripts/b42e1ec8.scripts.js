"use strict";angular.module("prevuApp",["ngCookies","ngResource","ngSanitize","ngRoute","ui.bootstrap"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/auteur",{templateUrl:"views/auteur.html",controller:"AuteurCtrl"}).when("/auteur/:search",{templateUrl:"views/auteur.html",controller:"AuteurCtrl"}).when("/livre",{templateUrl:"views/issues.html",controller:"IssuesCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("prevuApp").controller("MainCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("prevuApp").controller("AuteurCtrl",["$scope","$routeParams","$http","Books","prevuAPIservice",function(a,b,c,d,e){console.log(b.search);var f=function(b){var c=new Miso.Dataset({data:b.search});c.fetch({success:function(){a.stats={docs:this.length,issues:this.sum("issues"),issuesMax:this.max("issues"),issuesMin:this.min("issues"),renewals:this.sum("renewals"),male:this.sum("Male"),female:this.sum("Female"),years:this.mean("publicationyear").toFixed(2),pays:this.countBy("pays").toJSON(),langue:this.countBy("langue").toJSON()}}})};a.search=function(){e.searchBookByAuthor(a.queryTerm.author_nom).success(function(b){a.books=b,f(b)})},a.suggestAuthors=function(a){return c.get("http://localhost:8888/prevu/application/api/author/search/"+a).then(function(a){var b=[];return angular.forEach(a.data.search,function(a){b.push(a)}),b})}}]),angular.module("prevuApp").factory("Books",["$resource",function(a){return a("http://localhost:8888/prevu/application/api/search/:auteurName",{auteurName:"@auteurName"},{loan:{method:"PUT",params:{bookId:"@bookId"},isArray:!1}})}]),angular.module("prevuApp").directive("stupidTable",function(){return{restrict:"A",link:function(a,b){b.stupidtable(),b.on("aftertablesort",function(a,b){var c=$(this).find("th");c.find(".arrow").remove();var d=$.fn.stupidtable.dir,e=b.direction===d.ASC?"&uarr;":"&darr;";c.eq(b.column).append('<span class="arrow">'+e+"</span>")})}}}),angular.module("prevuApp").factory("prevuAPIservice",["$http",function(a){var b={};return b.searchAuthor=function(b){return a({url:"http://localhost:8888/prevu/application/api/author/search/"+b})},b.searchBook=function(b){return a({url:"http://localhost:8888/prevu/application/api/book/search/"+b})},b.searchBookByAuthor=function(b){return a({url:"http://localhost:8888/prevu/application/api/search/"+b})},b.searchIssuesByTitle=function(b){return a({url:"http://localhost:8888/prevu/application/api/issues/title/"+b})},b}]),angular.module("prevuApp").controller("IssuesCtrl",["$scope","$routeParams","$http","prevuAPIservice",function(a,b,c,d){var e=function(b){var c=new Miso.Dataset({data:b.issues});c.fetch({success:function(){a.stats={issues:this.length,sex:this.countBy("sex").toJSON(),ufr:this.countBy("Ufr").toJSON(),niveau:this.countBy("Niveau").toJSON(),etape:this.countBy("Etape").toJSON(),description:this.countBy("description").toJSON()}}})};a.search=function(){d.searchIssuesByTitle(a.queryTerm.title).success(function(b){a.issues=b.issues,e(b)})},a.suggestBooks=function(a){return c.get("http://localhost:8888/prevu/application/api/book/search/"+a).then(function(a){var b=[];return angular.forEach(a.data.search,function(a){b.push(a)}),b})}}]),angular.module("prevuApp").controller("HeadernavCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("prevuApp").directive("visTimeline",function(){return{template:"<div></div>",restrict:"A",scope:{value:"=value"},link:function(a,b){a.$watch("value",function(a){if(a){var c=[],d=0,e=document.getElementById("visualization");angular.forEach(a,function(a){c.push({id:d++,content:a.Niveau+" "+a.sex,start:a.issuedate,end:a.returndate,className:a.Niveau})});var f={};console.log(b);{new vis.Timeline(e,c,f)}}})}}});